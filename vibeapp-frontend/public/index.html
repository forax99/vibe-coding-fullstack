<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VibeApp - Frontend</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background-color: #f8f9fa; }
        .post-card { transition: transform 0.2s; cursor: pointer; }
        .post-card:hover { transform: translateY(-5px); }
    </style>
</head>
<body>
    <nav class="navbar navbar-dark bg-primary mb-4">
        <div class="container">
            <a class="navbar-brand" href="#">VibeApp Frontend</a>
        </div>
    </nav>

    <div class="container">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h2>게시글 목록 (Express Proxy 사용)</h2>
            <button class="btn btn-primary" onclick="loadPosts()">새로고침</button>
        </div>

        <div id="posts-list" class="row">
            <!-- 게시글이 여기에 동적으로 추가됩니다 -->
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script>
        async function loadPosts() {
            const postsList = document.getElementById('posts-list');
            postsList.innerHTML = '<div class="text-center"><div class="spinner-border text-primary" role="status"></div></div>';
            
            try {
                // Express 프록시를 통해 백엔드 API 호출
                const response = await axios.get('/api/posts');
                const posts = response.data.posts;
                
                postsList.innerHTML = '';
                if (posts.length === 0) {
                    postsList.innerHTML = '<div class="col-12 text-center text-muted">게시글이 없습니다.</div>';
                    return;
                }

                posts.forEach(post => {
                    const card = document.createElement('div');
                    card.className = 'col-md-6 col-lg-4 mb-4';
                    card.innerHTML = `
                        <div class="card h-100 shadow-sm post-card">
                            <div class="card-body">
                                <h5 class="card-title text-truncate">${post.title}</h5>
                                <p class="card-text text-muted small mb-2">조회수: ${post.views} | 작성일: ${new Date(post.createdAt).toLocaleDateString()}</p>
                                <p class="card-text">${post.content.substring(0, 100)}...</p>
                            </div>
                        </div>
                    `;
                    postsList.appendChild(card);
                });
            } catch (error) {
                console.error('Error:', error);
                postsList.innerHTML = '<div class="col-12 text-center text-danger">게시글을 불러오는데 실패했습니다. (백엔드 서버 확인 필요)</div>';
            }
        }

        // 초기 로딩
        document.addEventListener('DOMContentLoaded', loadPosts);
    </script>
</body>
</html>
